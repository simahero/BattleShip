(()=>{"use strict";const e=document.getElementById("game-holder"),t=document.getElementById("grid"),o=document.getElementById("game-info"),n=document.getElementById("game-form"),l=document.getElementById("name"),c=document.getElementById("color"),d=document.getElementById("game-code"),a=document.getElementById("grid-size"),r=document.getElementById("ships-count"),m=document.getElementById("game-details"),i=document.getElementById("room-code"),s=document.getElementById("timer"),g=document.getElementById("players"),y=document.getElementById("stage"),u=document.getElementById("turns"),p=document.getElementById("options-1"),f=document.getElementById("options-2"),E=document.getElementById("options-3"),I=document.getElementById("next"),B=document.getElementById("start"),h=document.getElementById("join"),b=document.getElementById("create"),C=document.getElementById("copy-button"),S=document.getElementById("copy-input");(function(){const v=io("");var x={gridSize:8,player:{name:localStorage.getItem("name")||"Player",color:localStorage.getItem("color")||"#ffffff"}};function k(e){v.emit("hit",{position:e.target.id})}function w(o){let n=e.clientWidth-2*parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-left")),l=e.clientHeight-2*parseInt(window.getComputedStyle(e,null).getPropertyValue("padding-top")),c=Math.min(n,l)/o;t.style.gridTemplateColumns=`repeat(${o}, ${c}px [col-start])`,t.style.gridTemplateRows=`repeat(${o}, ${c}px [col-start])`}function _(e){let o="";for(let t=0;t<e*e;t++)o+=`<div id="${t}" class="cell"></div>`;t.innerHTML=o,w(e),document.querySelectorAll(".cell").forEach((e=>{e.onclick=k}))}function z(e){document.querySelectorAll(".cell").forEach((e=>{e.style.backgroundColor="#ffffff"}));for(const[t,o]of Object.entries(e.players)){let e=o.color;o.isDead&&(document.getElementById(t).style.textDecoration="line-through"),o.ships.forEach((t=>{document.getElementById(t).style.backgroundColor=e}))}switch(e.bombedAres.forEach((e=>{if(-1===e.belongsTo)document.getElementById(e.position).style.backgroundColor="#3b3b3b";else{let t=document.getElementById(e.position);t.style.backgroundColor=e.belongsTo.color,t.style.border="10px solid #3b3b3b"}})),s.textContent=`${Math.round(e.timer)}`,u.textContent=`${e.turns}`,e.stage){case-1:y.textContent="Waiting for other players...";break;case 0:y.textContent="Placing ships";break;case 1:y.textContent="Battle!"}document.querySelectorAll("#players > li").forEach((e=>e.style.color="white")),e.que[e.currentPlayer]&&(document.getElementById(e.que[e.currentPlayer]).style.color="yellow"),e.que.length}window.onload=function(){_(8),l.placeholder=localStorage.getItem("name")||"Player",c.value=localStorage.getItem("color")||"#ffffff",f.style.display="none",E.style.display="none"},window.onresize=()=>w(x.gridSize),I.onclick=()=>{let e=l.value||localStorage.getItem("name"),t=c.value;x.player.name=e,x.player.color=t,localStorage.setItem("name",e),localStorage.setItem("color",t),p.style.display="none",f.style.display="flex"},b.onclick=()=>{f.style.display="none",E.style.display="flex"},h.onclick=()=>{v.emit("join_room",{gameCode:d.value,player:x.player})},B.onclick=()=>{v.emit("create_room",{gridSize:a.value,shipsCount:r.value,player:x.player}),n.style.display="none",m.style.display="flex",hasStarted=!0},C.onclick=()=>{S.select(),S.setSelectionRange(0,99999),document.execCommand("copy")},a.onchange=e=>{x.gridSize=e.target.value,_(e.target.value)},v.on("game_code",(e=>{i.textContent=e,S.value=e})),v.on("join_room",(e=>{for(const[t,o]of Object.entries(e))if(!document.getElementById(t)){const e=document.createElement("li");e.id=t;const n=document.createElement("p");n.textContent=o.name;const l=document.createElement("div");l.classList.add("colorHolder"),l.style.backgroundColor=o.color,e.append(l),e.appendChild(n),g.appendChild(e)}d.value="",n.style.display="none",m.style.display="flex"})),v.on("start_game",(e=>{const t=document.createElement("button");t.textContent="START",t.style.marginTop="auto",t.onclick=()=>{v.emit("start_game",e),t.remove()},m.appendChild(t)})),v.on("resize_grid",(e=>{x.gridSize=e,_(e)})),v.on("disconnect_room",(e=>{document.getElementById(e).remove()})),v.on("response",(e=>console.log(e))),v.on("in_game",(e=>{o.style.display="block",z(e)})),v.on("game_over",(e=>z(e)))}).call(void 0)})();